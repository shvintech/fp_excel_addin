<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <title>Toast Message</title>

    <style>
      @keyframes slide-up {
        0% {
          opacity: 0;
          transform: translateY(100px);
        }

        100% {
          opacity: 1;
          transform: translateY(0px);
        }
      }

      .animate-slide-up {
        animation: slide-up 0.5s ease-out forwards;
      }
    </style>
  </head>

  <body>
    <div class="flex flex-col justify-center items-center mt-8">
      <div
        id="toast-container"
        class="max-w-md w-full p-4 rounded-md shadow-md flex items-start gap-3 animate-slide-up"
      >
        <!-- Icon -->
        <svg
          id="toast-icon"
          class="w-6 h-6 flex-shrink-0"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          viewBox="0 0 24 24"
        >
          <path
            id="toast-icon-path"
            stroke-linecap="round"
            stroke-linejoin="round"
            d="M12 9v2m0 4h.01M4.93 19h14.14a2 2 0 001.77-3L13.77 5a2 2 0 00-3.54 0L3.16 16a2 2 0 001.77 3z"
          ></path>
        </svg>

        <!-- Message -->
        <div class="flex-1">
          <p id="toast-type" class="font-semibold"></p>
          <p id="toast-message" class="text-sm"></p>
        </div>
      </div>

      <button
        class="py-2.5 px-6 rounded-lg text-sm mt-8 font-medium text-white bg-[#0F783F] hover:bg-[#0d6735] transition-all duration-200 cursor-pointer"
        onclick="handleCloseDialog()"
      >
        Close Dialog
      </button>
    </div>

    <script>
      Office.onReady(() => {
        const urlParams = new URLSearchParams(window.location.search);
        const type = urlParams.get("type");
        const message = urlParams.get("msg");

        const icon = document.getElementById("toast-icon");
        const title = document.getElementById("toast-type");
        const iconPath = document.getElementById("toast-icon-path");
        const container = document.getElementById("toast-container");
        const messageContainer = document.getElementById("toast-message");

        if (title && type) {
          switch (type.toLowerCase()) {
            case "success":
              title.textContent = "Success";
              title.className = "font-semibold text-green-800";
              break;
            case "error":
              title.textContent = "Error";
              title.className = "font-semibold text-red-800";
              break;
            default:
              title.textContent = "Warning";
              title.className = "font-semibold text-yellow-800";
              break;
          }
        }

        if (messageContainer && message) {
          messageContainer.textContent = decodeURIComponent(message);
          switch (type?.toLowerCase()) {
            case "success":
              messageContainer.className = "text-green-700 text-sm";
              break;
            case "error":
              messageContainer.className = "text-red-700 text-sm";
              break;
            default:
              messageContainer.className = "text-yellow-700 text-sm";
              break;
          }
        }

        if (title && type) {
          switch (type?.toLowerCase()) {
            case "success":
              container.className += " bg-green-100 border-l-4 border-green-400 text-green-700";
              break;
            case "error":
              container.className += " bg-red-100 border-l-4 border-red-400 text-red-700";
              break;
            default:
              container.className += " bg-yellow-100 border-l-4 border-yellow-400 text-yellow-700";
              break;
          }
        }

        if (title && type) {
          switch (type?.toLowerCase()) {
            case "success":
              container.className += " bg-green-100 border-l-4 border-green-500 text-green-700";
              icon.className = "w-6 h-6 flex-shrink-0 text-green-600";
              iconPath.setAttribute("d", "M5 13l4 4L19 7");
              title.textContent = "Success";
              break;
            case "error":
              container.className += " bg-red-100 border-l-4 border-red-500 text-red-700";
              icon.className = "w-6 h-6 flex-shrink-0 text-red-600";
              iconPath.setAttribute("d", "M6 18L18 6M6 6l12 12");
              title.textContent = "Error";
              break;
            default:
              container.className += " bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700";
              icon.className = "w-6 h-6 flex-shrink-0 text-yellow-600";
              iconPath.setAttribute(
                "d",
                "M12 9v2m0 4h.01M4.93 19h14.14a2 2 0 001.77-3L13.77 5a2 2 0 00-3.54 0L3.16 16a2 2 0 001.77 3z"
              ); // warning icon
              title.textContent = "Warning";
              break;
          }
        }

        window.handleCloseDialog = () => {
          if (Office && Office.context && Office.context.ui) {
            Office.context.ui.messageParent("Dialog closed by user");
          }
          window.close();
        };
      });
    </script>
  </body>
</html>
